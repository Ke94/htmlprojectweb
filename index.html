<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鬼滅之刃介紹網</title>
    <!-- 引入 Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="CSS/TitleList.css">
    <!-- 引入 Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <!-- 導覽列 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">鬼滅之刃介紹網</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="切換導航">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link active" href="index.html">首頁</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="Characters.html" id="charactersDropdown" role="button">
                            角色介紹
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="charactersDropdown">
                            <li><a class="dropdown-item" href="Characters.html">角色列表</a></li>
                            <li class="dropdown-submenu">
                                <a class="dropdown-item dropdown-toggle" href="#">人物介紹</a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="Characters.html#tanjiro">炭治郎</a></li>
                                    <li><a class="dropdown-item" href="Characters.html#nezuko">彌豆子</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="Story.html">劇情簡介</a></li>
                    <li class="nav-item"><a class="nav-link" href="Music.html">主題曲</a></li>
                </ul>
                <!-- Google 登錄按鈕 -->
                <div id="g_id_onload"
                     data-client_id="825193728202-ji3tncr2jo2gma6q7uo7upgglvdu6ntr.apps.googleusercontent.com"
                     data-login_uri="https://ke94.github.io/htmlprojectweb/"
                     data-auto_prompt="false">
                </div>
                <div class="g_id_signin" data-type="standard" data-shape="pill" data-theme="outline"></div>
            </div>
        </div>
    </nav>

    <!-- 首頁 -->
    <section class="container mt-5">
        <h1 class="text-center">歡迎來到鬼滅之刃介紹網</h1>
        <p class="text-center">探索劇情、角色、音樂及更多精彩內容！</p>
    </section>

    <!-- 劇情簡介 -->
    <section id="plot" class="container mt-5">
        <h2>劇情簡介</h2>
        <p>在這裡，你將了解鬼滅之刃的主要故事情節及背景設置。</p>
        <button class="btn btn-primary">了解更多</button>
    </section>

    <!-- 引入 Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Google 登錄邏輯 -->
    <script>
        // Google 登錄的回調函數
        function handleCredentialResponse(response) {
            try {
                console.log("Encoded JWT ID token: " + response.credential);
                
                // 解碼並解析 Google ID Token
                const base64Url = response.credential.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
                
                const userInfo = JSON.parse(jsonPayload);
                console.log("Decoded ID Token:", userInfo);

                // 更新介面：顯示使用者名稱或登出按鈕
                const navBar = document.querySelector('.navbar-collapse');
                navBar.innerHTML += `<span class="navbar-text text-white ms-3">歡迎, ${userInfo.name}</span>`;
            } catch (error) {
                console.error("處理登錄回應時發生錯誤:", error);
            }
        }

        // 初始化 Google 登錄 API
        window.onload = function () {
            google.accounts.id.initialize({
                client_id: "825193728202-ji3tncr2jo2gma6q7uo7upgglvdu6ntr.apps.googleusercontent.com",
                callback: handleCredentialResponse,
                auto_select: true
            });

            google.accounts.id.renderButton(
                document.querySelector(".g_id_signin"),  // 綁定按鈕容器
                { theme: "outline", size: "medium", shape: "pill" }  // 配置按鈕外觀
            );

            google.accounts.id.prompt(); // 自動提示用戶登錄
        };
    </script>
</body>
</html>
